{% extends "layout.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12 mb-4">
        <div class="card shadow">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h2 class="h4 m-0 font-weight-bold text-primary">Market Trends</h2>
            </div>
            <div class="card-body">
                <!-- Market Trend Visualization -->
                <div class="mb-4">
                    <h3 class="h5 mb-3">Career Demand Overview</h3>
                    <div class="chart-container" style="position: relative; height: 300px;">
                        <canvas id="marketTrendsChart"></canvas>
                    </div>
                </div>
                
                <!-- Market Trends Table -->
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Career</th>
                                <th>Industry</th>
                                <th>Demand Level</th>
                                <th>Salary Range</th>
                                <th>Last Updated</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for trend in trends %}
                                <tr>
                                    <td>
                                        <a href="{{ url_for('career_details', career_id=trend.career.id) }}">
                                            {{ trend.career.name }}
                                        </a>
                                    </td>
                                    <td>{{ trend.career.industry }}</td>
                                    <td>
                                        <div class="progress" style="height: 10px;">
                                            <div class="progress-bar bg-info" role="progressbar" style="width: {{ trend.demand_level * 100 }}%"></div>
                                        </div>
                                        <span class="small text-muted">
                                            {% if trend.demand_level >= 0.8 %}
                                                Very High
                                            {% elif trend.demand_level >= 0.6 %}
                                                High
                                            {% elif trend.demand_level >= 0.4 %}
                                                Moderate
                                            {% elif trend.demand_level >= 0.2 %}
                                                Low
                                            {% else %}
                                                Very Low
                                            {% endif %}
                                        </span>
                                    </td>
                                    <td>${{ trend.salary_range }}</td>
                                    <td>{{ trend.updated_at.strftime('%B %d, %Y') }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <!-- Industry Insights -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="h5 mb-0">Industry Insights</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <h4 class="h6 mb-2">Technology</h4>
                                <p>Technology remains one of the fastest-growing sectors, with high demand for software engineers, data scientists, and cybersecurity professionals. Remote work opportunities have expanded significantly.</p>
                            </div>
                            <div class="col-md-6 mb-4">
                                <h4 class="h6 mb-2">Healthcare</h4>
                                <p>The healthcare industry continues to grow steadily with increasing demand for healthcare professionals, medical researchers, and healthcare administrators due to aging populations.</p>
                            </div>
                            <div class="col-md-6 mb-4">
                                <h4 class="h6 mb-2">Finance</h4>
                                <p>Financial analysts, investment advisors, and fintech professionals remain in high demand as digital transformation accelerates across the banking and investment sectors.</p>
                            </div>
                            <div class="col-md-6 mb-4">
                                <h4 class="h6 mb-2">Marketing</h4>
                                <p>Digital marketing continues to evolve rapidly, with increasing demand for specialists in content marketing, social media, SEO, and data-driven marketing strategies.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Extract career names and demand levels
        const careers = [
            {% for trend in trends %}
                "{{ trend.career.name }}",
            {% endfor %}
        ];
        
        const demandLevels = [
            {% for trend in trends %}
                {{ trend.demand_level }},
            {% endfor %}
        ];
        
        // Create market trends chart
        createMarketTrendsChart('marketTrendsChart', careers, demandLevels);
    });
</script>
{% endblock %}
